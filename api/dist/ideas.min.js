"use strict";var router=require("express").Router(),_require=require("../models"),Ideas=_require.Ideas,_require2=require("../models"),IdeasBought=_require2.IdeasBought,axios=require("axios"),LocalDateTime=require("@js-joda/core").LocalDateTime,mysql=require("mysql2"),db=mysql.createConnection({host:"localhost",user:"angerfist",password:"9662@#$%&",database:"bridge"});router.post("/create",function(r,t){var n,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n={pitcherid:r.body.pitcherid,pitch:r.body.pitch,price:r.body.price,time:LocalDateTime.now().toString()},e.next=3,regeneratorRuntime.awrap(Ideas.create(n));case 3:s=e.sent,t.json({pitch:s,message:"pitch created"});case 5:case"end":return e.stop()}})});var sequelize=require("sequelize"),res=require("express/lib/response");router.get("/",function(e,r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(Ideas.findAll({order:[[sequelize.literal("updatedAt")]]}));case 2:null==(t=e.sent)&&r.json("no ideas have been added!"),r.send(t.reverse());case 5:case"end":return e.stop()}})}),router.get("/ideasbought/:id",function(r,t){var n,s,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.params.id,e.prev=1,s=n.substr(1,n.length),console.log(s),e.next=6,regeneratorRuntime.awrap(IdeasBought.findAll({where:{customerid:s}}));case 6:a=e.sent,t.json(a),console.log(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("dont panick but it seems the the id was not submitted");case 14:case"end":return e.stop()}},null,null,[[1,11]])}),router.get("/ideascustomer/:id",function(r,t){var n,s,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.params.id,n.substr(1,n.length),e.next=4,regeneratorRuntime.awrap(Ideas.findAll({include:[{model:IdeasBought,required:!1}]}));case 4:s=e.sent,a=[],s.forEach(function(e,r,t){axios.get("http://localhost:3001/idea/ideas/:".concat(e.IdeaId)).then(function(e){a.push(e.data)})}),t.json(Ideas),console.log(Ideas);case 9:case"end":return e.stop()}})}),router.get("/ideas/:id",function(r,t){var n,s,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.params.id,e.prev=1,s=n.substr(1,n.length),console.log(s),e.next=6,regeneratorRuntime.awrap(Ideas.findAll({where:{id:s}}));case 6:a=e.sent,t.json(a),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}},null,null,[[1,10]])}),router.post("/bought",function(r,t){var n,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n={IdeaId:r.body.ideaid,customerid:r.body.customerid,time:LocalDateTime.now().toString()},e.next=3,regeneratorRuntime.awrap(IdeasBought.create(n));case 3:s=e.sent,t.json({pitch:s,message:"pitch created"});case 5:case"end":return e.stop()}})}),module.exports=router;
//# sourceMappingURL=ideas.min.js.map
