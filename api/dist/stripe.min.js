"use strict";var stripe=require("stripe")(process.env.secretKey),router=require("express")("Router");router.post("/sub",function(t,r){var n,s,a,c,i,o,p,u,m;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body,s=n.email,a=n.payment_method,c=n.price,console.log(c),i="2"===c?"price_1KQV3qIT6p7sbPTq9dyf157P":"5"===c?"price_1KQV5gIT6p7sbPTqlPwbvbyY":"price_1KQV6DIT6p7sbPTqWUQmN8NP",console.log(i),e.next=5,regeneratorRuntime.awrap(stripe.customers.create({payment_method:a,email:s,invoice_settings:{default_payment_method:a}}));case 5:return o=e.sent,e.next=8,regeneratorRuntime.awrap(stripe.subscriptions.create({customer:o.id,items:[{price:i}],expand:["latest_invoice.payment_intent"]}));case 8:p=e.sent,u=p.latest_invoice.payment_intent.status,m=p.latest_invoice.payment_intent.client_secret,r.json({client_secret:m,status:u});case 12:case"end":return e.stop()}})}),router.post("/pay",function(t,r){var n,s,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body,n.email,s=n.amount,e.next=3,regeneratorRuntime.awrap(stripe.paymentIntents.create({amount:s,currency:"usd",metadata:{integration_check:"accept_a_payment"}}));case 3:a=e.sent,r.json({client_secret:a.client_secret}),console.log(r);case 6:case"end":return e.stop()}})}),module.exports=router;
//# sourceMappingURL=stripe.min.js.map
